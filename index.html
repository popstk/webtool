<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Tool</title>
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.js"></script>

  <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
    crossorigin="anonymous">

  <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
  <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>
  <script src="https://unpkg.com/vue"></script>
  <script src="./js/base64.js"></script>
  <script src="./js/vkbeautify.js"></script>

  <link href="https://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
</head>

<body>
  <div class="container">
    <ul class="nav nav-tabs" id="items">
      <li v-for="item in items">
        <a :href="'#'+item.id" data-toggle="tab">{{item.name}}</a>
      </li>
    </ul>
    <div class="tab-content">
      <div class="tab-pane" id="jsxml">
        <textarea id="input_area" name="input_area" class="form-control" spellcheck="false"></textarea>
      </div>
      <div class="tab-pane" id="base64">
        <div class="col-md-6">
          <textarea id="input_text" class="form-control" rows="30" spellcheck="false" placeholder="明文" onkeyup="encode(this.value)"></textarea>
        </div>
        <div class="col-md-6">
          <textarea id="output_text" class="form-control" rows="30" spellcheck="false" placeholder="密文" onkeyup="decode(this.value)"></textarea>
        </div>
        <div class="col-md-6">
          <div>
            <pre><code id="preview">
              </code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // import content from './content'
    new Vue({
      el: '#items',
      data: {
        items: [{
          name: 'Base64',
          id: 'base64'
        }, {
          name: 'Json/XML',
          id: 'jsxml'
        }]
      }
    })
  </script>

  <script>
    $(document).ready(function () {
      $('#base64').addClass('active');
    });

    function formatter(text) {
      let out = text.replace(/^\s+|\s+$/g, "");
      if (out.length == 0)
        return text

      if (out[0] == '<')
        return vkbeautify.xml(out)
      else if (out[0] == '{' || out[0] == '[')
        return vkbeautify.json(out, 2)
      else if (out[out.length - 1] == '}')
        return vkbeautify.css(out)
      else
        return vkbeautify.sql(out)
    }

    function decode(text) {
      let res = Base64.decode(text);
      try {
        res = formatter(res);
        $('#preview').html(res);
      } catch (e) {
        console.log('Unsupported');
      }

      $('#input_text').val(res);
    }

    function encode(text) {
      $('#preview').html(text);
      let res = Base64.encode(text);
      $('#output_text').val(res);
    }
  </script>

</body>

</html>